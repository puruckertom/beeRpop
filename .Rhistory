varroainput16 <- paste(parameter16, inputvalue16, sep= " ")
write(varroainput16, file= paste(vpdir_input, "input", i, ".txt", sep=""), append= TRUE)
}
tdarray <- array(data=NA,c(1827,26,1000))
dim(tdarray)
library(abind)
for (i in 1:1000) {
df<- read.table(paste(vpdir_output,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
newarray2<- data.matrix(newarray)
tdarray[1:1827,1:26,i] <- abind(newarray2[1:1827,1:26], along=3)
}
save(tdarray, file = paste(vpdir_output,"tdarray.RData", sep = ""))
#library dependencies
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
#echo environment
Sys.info()
Sys.info()[4]
.Platform
version
#Determine path directory based on the user machine######
#tom epa windows
if(Sys.info()[4]=="DC2626UTPURUCKE"){
vpdir<-path.expand("C:/git/beeRpop/")
}
#tom epa windows 2
if(Sys.info()[4]=="DZ2626UTPURUCKE"){
vpdir<-path.expand("C:/git/beeRpop/")
}
#marcia epa computer
if(Sys.info()[4]=="LZ2626UMSNYDE02"){
vpdir<-path.expand("C:/Users/msnyde02/varroapoptest2/")
}
#carmen personal laptop
if(Sys.info()[4]or("Ashleys-MBP","Ashleys-MacBook-Pro.local")) {
vpdir<-path.expand("~/git/beeRpop/")
}
#carmen epa desktop
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
}
#andrew epa
if(Sys.info()[4]=="LZ2032EAKANAREK"){
vpdir <- path.expand("C:/Users/AKanarek/Documents/GitHub/beeRpop/")
}
#tom laptop
if(Sys.info()[4]=="stp-air.local"){
vpdir<-path.expand("~/git/beeRpop/")
}
#subdirectories
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "fig/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
#number of simulations
Nsims <- 1000
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
#weather
#the .vrp file has to know where the weather file is, R cannot tell it!
#run everything
source(paste(vpdir,"01parameterize_simulation.R",sep = ""))
source(paste(vpdir,"02simulate_w_exe.R",sep = ""))
source(paste(vpdir,"03read_output.R",sep = ""))
source(paste(vpdir,"04load_io.R",sep = ""))
source(paste(vpdir,"05sensitivity_analyses.R",sep = ""))
source(paste(vpdir,"06plotting_neonic_generic.R",sep = ""))
##########################################################
# #git stuff - you only need to do this once
# #install
# https://help.github.com/desktop/guides/getting-started/installing-github-desktop/
#
# # to clone this onto a machine with github installed
# #navigate in the github shell to a directory where you have read/write privileges
# #then from the directory above where you want to install the R source code:
# git clone https://github.com/puruckertom/beeRpop.git
# #####
#
# #git stuff you have to do more often
# #switch into that directory
# cd beeRpop
# #check status (you should be )
# git status
# #check for changes on this and other branches
# git fetch
# #checkout a different branch
# git branch
# git checkout andrew
#
# #after making some changes and you want to push those changes to the cloud
# git fetch
# git pull
# git commit -am "some explanatory message about what this commit was about"
# git push
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
Sys.info()[4]
if(Sys.info()[4]=="Ashleys-MBP"||Sys.info()[4]=="Ashleys-MacBook-Pro.local"||Sys.info()[4]=="Ashleys-MBP-2") {
vpdir<-path.expand("~/git/beeRpop/")
}
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "fig/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_exp <- paste(vpdir_input, "exposed/", sep = "")
vpdir_in_con <- paste(vpdir_input, "control/", sep = "")
vpdir_out_exp <- paste(vpdir_output, "exposed/", sep = "")
vpdir_out_con <- paste(vpdir_output, "control/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
#number of simulations
Nsims <- 1000
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
#weather file
#can be .dvf or .wth
vrp_weather <- "w93193-tempadj.dvf"
#simulation start and end
#must have mm/dd/yyyy format
simstart <- "01/01/1988"
simend <- "12/31/1990"
source(paste(vpdir,"01parameterize_simulation.R",sep = ""))
scan(file = paste(vpdir_log, "log1.txt", sep=""), what = "raw")
source(paste(vpdir,"02simulate_w_exe.R",sep = ""))
vpdir_in_exp
vpdir_exe
vpdir_command
source(paste(vpdir,"02write_input.R",sep = ""))
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
#carmen epa desktop
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
}
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "fig/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_exp <- paste(vpdir_input, "exposed/", sep = "")
vpdir_in_con <- paste(vpdir_input, "control/", sep = "")
vpdir_out_exp <- paste(vpdir_output, "exposed/", sep = "")
vpdir_out_con <- paste(vpdir_output, "control/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
#number of simulations
Nsims <- 1000
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
#weather file
#can be .dvf or .wth
vrp_weather <- "w93193-tempadj.dvf"
#simulation start and end
#must have mm/dd/yyyy format
simstart <- "01/01/1988"
simend <- "12/31/1990"
weather_file<- rep(paste(vrp_weather, sep = ""), Nsims)
sim_start<- rep(paste(simstart, sep = ""), Nsims)
sim_end<- rep(paste(simend, sep = ""), Nsims)
##initial conditions
#drnadults
#wkradults
#drnbrood
#wkrbrood
#drnlarv
#wkrlarv
#drneggs
#wkreggs
queenstrength<- runif(Nsims, 1, 6) #ICQueenStrength
fgrlifespan <- runif(Nsims, 4, 16) #ICForagerLifespan
#drnadultinfest
#drnbroodinfest
#drnmiteoffspring
drnmitesurvive<- runif(Nsims, 0, 100) #ICDroneMiteSurvivorship
#wkradultinfest
#wkrbroodinfest
#wkrmiteoffspring
wkrmitesurvive<- runif(Nsims, 0, 100) #ICWorkerMiteSurvivorship
##plotting
#PlotNone
#PlotAD
#PlotAW
#PlotCS
#PlotDB
#PlotDE
#PlotDL
#PlotF
#PlotTM
#PlotMDB
#PlotMWB
#PlotPDB
#PlotPWB
#PlotPRM
#PlotRM
#PlotWB
#PlotWE
#PlotWL
#PlotIM
##
wkrdrnratio<- runif(Nsims, 1, 5) #RQWkrDrnRatio
immtype <- c("Polynomial", "Cosine", "Sine", "Exponential", "Tangent", "Logarithmic")
miteimmtype <- sample(immtype, size=Nsims, replace=T) #ImmType
#pesticide exposure
adslope<- runif(Nsims, 0, 3.93) #AIAdultSlope
adLD50<- runif(Nsims, 0, 0.2) #AIAdultLD50 (ug/bee)
adslopec<- runif(Nsims, 0, 3.93) #AIAdultSlopeContact
adLD50c<- runif(Nsims, 0, 0.05) #AIAdultLD50Contact (ug/bee)
lslope<- runif(Nsims, 0, 3.4) #AILarvaSlope
lLD50<- runif(Nsims, 0, 0.9) #AILarvaLD50 (ug/larva)
kow<- runif(Nsims, 2, 6) #AIKOW
koc<- runif(Nsims, 5, 30) #AIKOC
halflife<- runif(Nsims, 0, 2.9) #AIHalfLife (days)
apprate_con<- runif(Nsims, 0, 0.0) #EAppRate (lb/A)
apprate_exp<- runif(Nsims, 0, 10) #EAppRate (lb/A)
foliar_true<- rep("true", Nsims)
foliar_false<- rep("false", Nsims)
inputdata_con<- data.frame(queenstrength,wkrdrnratio, drnmitesurvive, wkrmitesurvive, fgrlifespan, miteimmtype,
adslope,adLD50,adslopec,adLD50c,lslope,lLD50,kow,koc,halflife,apprate_con, foliar_false)
inputdata_exp<- data.frame(queenstrength,wkrdrnratio, drnmitesurvive, wkrmitesurvive, fgrlifespan, miteimmtype,
adslope,adLD50,adslopec,adLD50c,lslope,lLD50,kow,koc,halflife,apprate_exp, foliar_true)
#putting the input in the io directory so it can be read from there later
write.csv(inputdata_con, file = paste(vpdir_out_con, "inputdata_con.csv", sep = ""))
write.csv(inputdata_exp, file = paste(vpdir_out_exp, "inputdata_exp.csv", sep = ""))
#create input files #########
#CONTROL
for (i in 1:Nsims) {
parameter <- ("ICQueenStrength=") #queen strength
inputvalue <- queenstrength[i]
parameter2 <- ("RQWkrDrnRatio=") #requeen worker-drone ratio
inputvalue2 <- wkrdrnratio[i]
parameter3 <- ("ICDroneMiteSurvivorship=") #drone-mite survivorship
inputvalue3 <- drnmitesurvive[i]
parameter4 <- ("ICWorkerMiteSurvivorship=")  #worker-mite survivorship
inputvalue4 <- wkrmitesurvive[i]
parameter5 <- ("ICForagerLifespan=")  #Forager Lifespan
inputvalue5 <- fgrlifespan[i]
parameter6 <- ("ImmType=")   #Mite Immigration Type
inputvalue6 <- miteimmtype[i]
parameter7 <- ("AIAdultSlope=") #ai adult slope
inputvalue7 <- adslope[i]
parameter8 <- ("AIAdultLD50=") #ai adult LD50
inputvalue8 <- adLD50[i]
parameter9 <- ("AIAdultSlopeContact=") #ai adult slope contact
inputvalue9 <- adslopec[i]
parameter10 <- ("AIAdultLD50Contact=") #ai adult LD50 contact
inputvalue10 <- adLD50c[i]
parameter11 <- ("AILarvaSlope=") #ai larva slope
inputvalue11 <- lslope[i]
parameter12 <- ("AILarvaLD50=") #ai larva LD50
inputvalue12 <- lLD50[i]
parameter13 <- ("AIKOW=") #ai kow
inputvalue13 <- kow[i]
parameter14 <- ("AIKOC=") #ai koc
inputvalue14 <- koc[i]
parameter15 <- ("AIHalfLife=") #ai half life (days)
inputvalue15 <- halflife[i]
parameter16 <- ("EAppRate=") #application rate (lb/A)
inputvalue16<- apprate_con[i]
parameter17 <- ("FoliarEnabled=") #foliar spray enable
inputvalue17<- foliar_false[i]
varroainput <- paste(parameter,inputvalue, sep=" ")
write(varroainput, file = paste(vpdir_in_con, "input",i,".txt", sep = ""), append = FALSE)
varroainput2 <- paste(parameter2,inputvalue2, sep=" ")
write(varroainput2, file = paste(vpdir_in_con, "input",i,".txt", sep = ""), append = TRUE, sep = "\n")
varroainput3 <- paste(parameter3, inputvalue3, sep=" ")
write(varroainput3, file = paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput4 <- paste(parameter4, inputvalue4, sep=" ")
write(varroainput4, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput5 <- paste(parameter5, inputvalue5, sep= " ")
write(varroainput5, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput6 <- paste(parameter6, inputvalue6, sep= " ")
write(varroainput6, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput7 <- paste(parameter7, inputvalue7, sep= " ")
write(varroainput7, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput8 <- paste(parameter8, inputvalue8, sep= " ")
write(varroainput8, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput9 <- paste(parameter9, inputvalue9, sep= " ")
write(varroainput9, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput10 <- paste(parameter10, inputvalue10, sep= " ")
write(varroainput10, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput11 <- paste(parameter11, inputvalue11, sep= " ")
write(varroainput11, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput12 <- paste(parameter12, inputvalue12, sep= " ")
write(varroainput12, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput13 <- paste(parameter13, inputvalue13, sep= " ")
write(varroainput13, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput14 <- paste(parameter14, inputvalue14, sep= " ")
write(varroainput14, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput15 <- paste(parameter15, inputvalue15, sep= " ")
write(varroainput15, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput16 <- paste(parameter16, inputvalue16, sep= " ")
write(varroainput16, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput17 <- paste(parameter17, inputvalue17, sep= " ")
write(varroainput17, file= paste(vpdir_in_con, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
}
#EXPOSED
for (i in 1:Nsims) {
parameter <- ("ICQueenStrength=") #queen strength
inputvalue <- queenstrength[i]
parameter2 <- ("RQWkrDrnRatio=") #requeen worker-drone ratio
inputvalue2 <- wkrdrnratio[i]
parameter3 <- ("ICDroneMiteSurvivorship=") #drone-mite survivorship
inputvalue3 <- drnmitesurvive[i]
parameter4 <- ("ICWorkerMiteSurvivorship=")  #worker-mite survivorship
inputvalue4 <- wkrmitesurvive[i]
parameter5 <- ("ICForagerLifespan=")  #Forager Lifespan
inputvalue5 <- fgrlifespan[i]
parameter6 <- ("ImmType=")   #Mite Immigration Type
inputvalue6 <- miteimmtype[i]
parameter7 <- ("AIAdultSlope=") #ai adult slope
inputvalue7 <- adslope[i]
parameter8 <- ("AIAdultLD50=") #ai adult LD50
inputvalue8 <- adLD50[i]
parameter9 <- ("AIAdultSlopeContact=") #ai adult slope contact
inputvalue9 <- adslopec[i]
parameter10 <- ("AIAdultLD50Contact=") #ai adult LD50 contact
inputvalue10 <- adLD50c[i]
parameter11 <- ("AILarvaSlope=") #ai larva slope
inputvalue11 <- lslope[i]
parameter12 <- ("AILarvaLD50=") #ai larva LD50
inputvalue12 <- lLD50[i]
parameter13 <- ("AIKOW=") #ai kow
inputvalue13 <- kow[i]
parameter14 <- ("AIKOC=") #ai koc
inputvalue14 <- koc[i]
parameter15 <- ("AIHalfLife=") #ai half life (days)
inputvalue15 <- halflife[i]
parameter16 <- ("EAppRate=") #application rate (lb/A)
inputvalue16<- apprate_exp[i]
parameter17 <- ("FoliarEnabled=") #foliar spray enabled
inputvalue17<- foliar_true[i]
varroainput <- paste(parameter,inputvalue, sep=" ")
write(varroainput, file = paste(vpdir_in_exp, "input",i,".txt", sep = ""), append = FALSE)
varroainput2 <- paste(parameter2,inputvalue2, sep=" ")
write(varroainput2, file = paste(vpdir_in_exp, "input",i,".txt", sep = ""), append = TRUE, sep = "\n")
varroainput3 <- paste(parameter3, inputvalue3, sep=" ")
write(varroainput3, file = paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput4 <- paste(parameter4, inputvalue4, sep=" ")
write(varroainput4, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput5 <- paste(parameter5, inputvalue5, sep= " ")
write(varroainput5, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput6 <- paste(parameter6, inputvalue6, sep= " ")
write(varroainput6, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput7 <- paste(parameter7, inputvalue7, sep= " ")
write(varroainput7, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput8 <- paste(parameter8, inputvalue8, sep= " ")
write(varroainput8, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput9 <- paste(parameter9, inputvalue9, sep= " ")
write(varroainput9, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput10 <- paste(parameter10, inputvalue10, sep= " ")
write(varroainput10, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput11 <- paste(parameter11, inputvalue11, sep= " ")
write(varroainput11, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput12 <- paste(parameter12, inputvalue12, sep= " ")
write(varroainput12, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput13 <- paste(parameter13, inputvalue13, sep= " ")
write(varroainput13, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput14 <- paste(parameter14, inputvalue14, sep= " ")
write(varroainput14, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput15 <- paste(parameter15, inputvalue15, sep= " ")
write(varroainput15, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput16 <- paste(parameter16, inputvalue16, sep= " ")
write(varroainput16, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput17 <- paste(parameter17, inputvalue17, sep= " ")
write(varroainput17, file= paste(vpdir_in_exp, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
}
#EXPOSED
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, "VarroaPop_3_2_6_0.exe ", vpdir_exe, "comparison.vrp",
" /b /or ", vpdir_out_exp, outputfile,
" /i ", vpdir_in_exp, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(vpdir_command)
system(vpdir_command)
}
# load up varroapop data into a 3d array dataframe ######
df <- read.table(paste(vpdir_out_con,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
tdarray_con <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_con)
tdarray_exp <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_exp)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
# read output files
#CONTROL
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_con,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_con[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#EXPOSED
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_exp,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_exp[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
# save tdarray
save(tdarray_con, file = paste(vpdir_out_con,"tdarray_con.RData", sep = ""))
save(tdarray_exp, file = paste(vpdir_out_exp,"tdarray_exp.RData", sep = ""))
save(timearray,file = paste(vpdir_output,"timearray.RData", sep = ""))
for (i in 1:2) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,".txt", sep="")
vpdir_command <- paste(vpdir_exe, "VarroaPop_3_2_6_0.exe ", vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_con, outputfile,
" /i ", vpdir_in_con, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(vpdir_command)
system(vpdir_command)
}
#the .vrp file has to know where the weather file is, R cannot tell it!
#CONTROL
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,".txt", sep="")
vpdir_command <- paste(vpdir_exe, "VarroaPop_3_2_6_0.exe ", vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_con, outputfile,
" /i ", vpdir_in_con, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(vpdir_command)
system(vpdir_command)
}
# load up varroapop data into a 3d array dataframe ######
df <- read.table(paste(vpdir_out_con,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
tdarray_con <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_con)
tdarray_exp <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_exp)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
# read output files
#CONTROL
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_con,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_con[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#EXPOSED
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_exp,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_exp[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
# save tdarray
save(tdarray_con, file = paste(vpdir_out_con,"tdarray_con.RData", sep = ""))
save(tdarray_exp, file = paste(vpdir_out_exp,"tdarray_exp.RData", sep = ""))
save(timearray,file = paste(vpdir_output,"timearray.RData", sep = ""))
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "fig/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_exp <- paste(vpdir_input, "exposed/", sep = "")
vpdir_in_con <- paste(vpdir_input, "control/", sep = "")
vpdir_out_exp <- paste(vpdir_output, "exposed/", sep = "")
vpdir_out_con <- paste(vpdir_output, "control/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
#number of simulations
Nsims <- 1000
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
#weather file
#can be .dvf or .wth
vrp_weather <- "w93193-tempadj.dvf"
#simulation start and end
#must have mm/dd/yyyy format
simstart <- "01/01/1988"
simend <- "12/31/1990"
