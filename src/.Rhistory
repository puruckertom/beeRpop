library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
Sys.info()
Sys.info()[4]
#carmen epa desktop 2
if(Sys.info()[4]=="DZ2626UCKUAN"){
vpdir<-path.expand("C:/Users/ckuan/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "figures/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_foliar <- paste(vpdir_input, "foliar/", sep = "")
vpdir_in_control <- paste(vpdir_input, "control/", sep = "")
vpdir_in_seed <- paste(vpdir_input, "seed/", sep = "")
vpdir_in_soil <- paste(vpdir_input, "soil/", sep = "")
vpdir_out_foliar <- paste(vpdir_output, "foliar/", sep = "")
vpdir_out_control <- paste(vpdir_output, "control/", sep = "")
vpdir_out_seed <- paste(vpdir_output, "seed/", sep = "")
vpdir_out_soil <- paste(vpdir_output, "soil/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
vpdir_sobol <- paste(vpdir, "sobol/", sep = "")
#varroapop executable version
vp_binary <- "VarroaPop_3_2_6_3.exe"
vpdir_executable <- paste(vpdir_exe, vp_binary, sep="")
#number of simulations
Nsims <- 1000
#weather file
#can be .dvf or .wth
vrp_weather <- "w93193-tempadj.dvf"
#vrp_weather <- "Midwest5Yr.wth"
#simulation start and end
#must have mm/dd/yyyy format
simstart <- "01/01/1988"
simend <- "12/31/1990"
#run everything
# define distributions for input parameters
source(paste(vpdir,"src/01parameterize_simulation.R",sep = ""))
scan(file = paste(vpdir_log, "log1.txt", sep=""), what = "raw")
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
# read text files and save results in 3d arrays
source(paste(vpdir,"src/04read_output.R",sep = ""))
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
print(paste(file.exists(vpdir_executable), ": executable file at", vpdir_executable))
#sample input
sample_input_file <- paste(vpdir_in_control, "input1000.txt", sep="")
print(paste(file.exists(sample_input_file), ": sample input file at", sample_input_file))
#varroapop file
varroapop_file <- paste(vpdir_exe, vrp_filename, sep="")
print(paste(file.exists(varroapop_file), ": varroapop inputs file at", varroapop_file))
vrp_filename
vrp_filename <- "comparison_stp.vrp"
vrp_filename
varroapop_file <- paste(vpdir_exe, vrp_filename, sep="")
print(paste(file.exists(varroapop_file), ": varroapop inputs file at", varroapop_file))
weather_input <- paste(vpdir_exe, vrp_weather, sep="")
print(paste(file.exists(weather_input), ": weather file at", weather_input))
#varroapop <-> weather file message
print("the .vrp file has to know where the weather file is, R cannot tell it!")
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,".txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_control, outputfile,
" /i ", vpdir_in_control, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_foliar, outputfile,
" /i ", vpdir_in_foliar, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_seed, outputfile,
" /i ", vpdir_in_seed, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
#SOIL
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_soil, outputfile,
" /i ", vpdir_in_soil, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_foliar, outputfile,
" /i ", vpdir_in_foliar, inputfile, " /ol ", vpdir_log, logfile, sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_foliar, outputfile,
" /i ", vpdir_in_foliar, inputfile, " /ol ", vpdir_log, logfile, sep="")
vpdir_exe
vrp_filename
vpdir_out_foliar, outputfile
vpdir_out_foliar
outputfile
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_foliar, outputfile,
" /i ", vpdir_in_foliar, inputfile, " /ol ", vpdir_log, logfile, sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_seed, outputfile,
" /i ", vpdir_in_seed, inputfile, " /ol ", vpdir_log, logfile, sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_seed, outputfile,
" /i ", vpdir_in_seed, inputfile, " /ol ", vpdir_log, logfile, sep="")
vpdir_log
Nsims
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,".txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_control, outputfile,
" /i ", vpdir_in_control, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_foliar, outputfile,
" /i ", vpdir_in_foliar, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
#SEED
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_seed, outputfile,
" /i ", vpdir_in_seed, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
for (i in 1:Nsims) {
# n<-inputtest[i]
inputfile<- paste("input",i,".txt", sep="")
outputfile<- paste("results",i,".txt", sep="")
logfile<- paste("log",i,"exp.txt", sep="")
vpdir_command <- paste(vpdir_exe, vrp_filename,
" /b /or ", vpdir_out_soil, outputfile,
" /i ", vpdir_in_soil, inputfile, " /ol ", vpdir_log, logfile, sep="")
print(paste(vpdir_executable, vpdir_command, sep=" "))
system2(vpdir_executable, vpdir_command)
}
df <- read.table(paste(vpdir_out_con,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
tdarray_control <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_control)
tdarray_foliar <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_foliar)
tdarray_seed <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_seed)
tdarray_soil <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_soil)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
# read output files
#CONTROL
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_control[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#FOLIAR
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_foliar,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_foliar[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#SEED
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_seed,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_seed[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#FOLIAR
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_soil,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_soil[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
# save tdarray
save(tdarray_control, file = paste(vpdir_out_control,"tdarray_control.RData", sep = ""))
save(tdarray_foliar, file = paste(vpdir_out_foliar,"tdarray_foliar.RData", sep = ""))
save(tdarray_seed, file = paste(vpdir_out_seed,"tdarray_seed.RData", sep = ""))
save(tdarray_soil, file = paste(vpdir_out_soil,"tdarray_soil.RData", sep = ""))
save(timearray,file = paste(vpdir_output,"timearray.RData", sep = ""))
# load up varroapop data into a 3d array dataframe ######
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
nrows
tdarray_control <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_control)
tdarray_foliar <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_foliar)
tdarray_seed <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_seed)
tdarray_soil <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_soil)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_control[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#FOLIAR
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_foliar,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_foliar[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#SEED
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_seed,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_seed[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
#FOLIAR
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_soil,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_soil[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
# save tdarray
save(tdarray_control, file = paste(vpdir_out_control,"tdarray_control.RData", sep = ""))
save(tdarray_foliar, file = paste(vpdir_out_foliar,"tdarray_foliar.RData", sep = ""))
save(tdarray_seed, file = paste(vpdir_out_seed,"tdarray_seed.RData", sep = ""))
save(tdarray_soil, file = paste(vpdir_out_soil,"tdarray_soil.RData", sep = ""))
save(timearray,file = paste(vpdir_output,"timearray.RData", sep = ""))
memory.size
?rm
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
#echo environment
Sys.info()
Sys.info()[4]
.Platform
version
#Determine path directory based on the user machine######
#tom epa windows
if(Sys.info()[4]=="DC2626UTPURUCKE"){
vpdir<-path.expand("C:/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#tom epa windows 2
if(Sys.info()[4]=="DZ2626UTPURUCKE"){
vpdir<-path.expand("k:/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison_stp_epaw.vrp"
}
#marcia epa computer
if(Sys.info()[4]=="LZ2626UMSNYDE02"){
vpdir<-path.expand("C:/Users/msnyde02/varroapoptest2/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#carmen personal laptop
if(Sys.info()[4]=="Ashleys-MBP"||Sys.info()[4]=="Ashleys-MacBook-Pro-2.local"||
Sys.info()[4]=="Ashleys-MBP-2"||Sys.info()[4]=="Ashleys-MacBook-Pro.local") {
vpdir<-path.expand("~/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#carmen epa desktop
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#carmen epa desktop 2
if(Sys.info()[4]=="DZ2626UCKUAN"){
vpdir<-path.expand("C:/Users/ckuan/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#andrew epa
if(Sys.info()[4]=="LZ2032EAKANAREK"){
vpdir <- path.expand("C:/Users/AKanarek/Documents/GitHub/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
#tom laptop
if(Sys.info()[4]=="stp-air.local"){
vpdir<-path.expand("~/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison.vrp"
}
if(Sys.info()[4]=="DZ2626UKWOLFE"){
vpdir<-path.expand("E:/VarroaPop/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison_kurt.vrp"
}
#subdirectories
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "figures/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_foliar <- paste(vpdir_input, "foliar/", sep = "")
vpdir_in_control <- paste(vpdir_input, "control/", sep = "")
vpdir_in_seed <- paste(vpdir_input, "seed/", sep = "")
vpdir_in_soil <- paste(vpdir_input, "soil/", sep = "")
vpdir_out_foliar <- paste(vpdir_output, "foliar/", sep = "")
vpdir_out_control <- paste(vpdir_output, "control/", sep = "")
vpdir_out_seed <- paste(vpdir_output, "seed/", sep = "")
vpdir_out_soil <- paste(vpdir_output, "soil/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
vpdir_sobol <- paste(vpdir, "sobol/", sep = "")
#varroapop executable version
vp_binary <- "VarroaPop_3_2_6_3.exe"
vpdir_executable <- paste(vpdir_exe, vp_binary, sep="")
#number of simulations
Nsims <- 1000
#weather file
#can be .dvf or .wth
vrp_weather <- "w93193-tempadj.dvf"
#vrp_weather <- "Midwest5Yr.wth"
#simulation start and end
#must have mm/dd/yyyy format
simstart <- "01/01/1988"
simend <- "12/31/1990"
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
tdarray_control <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_control)
tdarray_foliar <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_foliar)
tdarray_seed <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_seed)
tdarray_soil <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_soil)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
i <- 1
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
dim(df)
nrows <- dim(df[1])[[1]] #this is dependent on the duration of the simulation as set in the comparison.vrp file
tdarray_control <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_control)
tdarray_foliar <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_foliar)
tdarray_seed <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_seed)
tdarray_soil <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_soil)
timearray<- array(data=NA, c(nrows))
timearray[2:nrows]<- df[2:nrows,1]
timearray<- as.Date(timearray,"%m/%d/%Y")
timediff <- timearray[3]-timearray[2]
timearray[1] <- timearray[2]-timediff
length(timearray)
tdarray_control <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_control)
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_control,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_control[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
save(tdarray_control, file = paste(vpdir_out_control,"tdarray_control.RData", sep = ""))
rm(tdarray_control)
tdarray_foliar <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_foliar)
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_foliar,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_foliar[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
save(tdarray_foliar, file = paste(vpdir_out_foliar,"tdarray_foliar.RData", sep = ""))
rm(tdarray_foliar)
tdarray_seed <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_seed)
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_seed,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_seed[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
save(tdarray_seed, file = paste(vpdir_out_seed,"tdarray_seed.RData", sep = ""))
rm(tdarray_seed)
tdarray_soil <- array(data=NA, c(nrows,26,Nsims))
dim(tdarray_soil)
for (i in 1:Nsims) {
df <- read.table(paste(vpdir_out_soil,"results",i,".txt", sep=""), header= FALSE, sep= "",
skip = 6, stringsAsFactors = FALSE, row.names=NULL)
newarray <- df[,2:27]
tdarray_soil[1:nrows,1:26,i] <- abind(newarray[1:nrows,1:26], along=3)
}
save(tdarray_soil, file = paste(vpdir_out_soil,"tdarray_soil.RData", sep = ""))
rm(tdarray_soil)
save(timearray,file = paste(vpdir_output,"timearray.RData", sep = ""))
