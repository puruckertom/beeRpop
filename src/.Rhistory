write(varroainput15, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput15, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput15, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput15, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput16 <- paste(parameter16, inputvalue16, sep= " ")
write(varroainput16, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput16, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput16, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput16, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput17 <- paste(parameter17, inputvalue17, sep= " ")
write(varroainput17, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput17, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput17, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput17, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput18 <- paste(parameter18, inputvalue18, sep= " ")
write(varroainput18, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput19 <- paste(parameter19, inputvalue19, sep= " ")
write(varroainput19, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput20 <- paste(parameter20, inputvalue20, sep= " ")
write(varroainput20, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput21 <- paste(parameter21, inputvalue21, sep= " ")
write(varroainput21, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
varroainput22 <- paste(parameter22, inputvalue22, sep= " ")
write(varroainput22, file = paste(vpdir_in_foliar, "input",i,".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput22, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput22, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput22, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput23 <- paste(parameter23, inputvalue23, sep=" ")
write(varroainput23, file = paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput23, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput23, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput23, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput24 <- paste(parameter24, inputvalue24, sep=" ")
write(varroainput24, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput24, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput24, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput24, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput25 <- paste(parameter25, inputvalue25, sep= " ")
write(varroainput25, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput25, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput25, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput25, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput26 <- paste(parameter26, inputvalue26, sep= " ")
write(varroainput26, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput26, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput26, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput26, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput27 <- paste(parameter27, inputvalue27, sep= " ")
write(varroainput27, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput27, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput27, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput27, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput28 <- paste(parameter28, inputvalue28, sep= " ")
write(varroainput28, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput28, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput28, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput28, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput29 <- paste(parameter29, inputvalue29, sep= " ")
write(varroainput29, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput29, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput29, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput29, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput30 <- paste(parameter30, inputvalue30, sep= " ")
write(varroainput30, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput30, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput30, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput30, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput31 <- paste(parameter31, inputvalue31, sep= " ")
write(varroainput31, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput31, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput31, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput31, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput32 <- paste(parameter32, inputvalue32, sep= " ")
write(varroainput32, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput32, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput32, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput32, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput33 <- paste(parameter33, inputvalue33, sep= " ")
write(varroainput33, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput33, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput33, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput33, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput34 <- paste(parameter34, inputvalue34, sep= " ")
write(varroainput34, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput34, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput34, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput34, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput35 <- paste(parameter35, inputvalue35, sep= " ")
write(varroainput35, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput35, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput35, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput35, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput36 <- paste(parameter36, inputvalue36, sep= " ")
write(varroainput36, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput36, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput36, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput36, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput37 <- paste(parameter37, inputvalue37, sep= " ")
write(varroainput37, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput37, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput37, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput37, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput38 <- paste(parameter38, inputvalue38, sep= " ")
write(varroainput38, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE, sep = "\n")
write(varroainput38, file = paste(vpdir_in_control, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput38, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write(varroainput38, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput39 <- paste(parameter39, inputvalue39, sep= " ")
write(varroainput39, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput40 <- paste(parameter40, inputvalue40, sep= " ")
write(varroainput40, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput41 <- paste(parameter41, inputvalue41, sep= " ")
write(varroainput41, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput42 <- paste(parameter42, inputvalue42, sep= " ")
write(varroainput42, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput43 <- paste(parameter43, inputvalue43, sep= " ")
write(varroainput43, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput44 <- paste(parameter44, inputvalue44, sep= " ")
write(varroainput44, file = paste(vpdir_in_soil, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput45 <- paste(parameter45, inputvalue45, sep= " ")
write(varroainput45, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput46 <- paste(parameter46, inputvalue46, sep= " ")
write(varroainput46, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
varroainput47 <- paste(parameter47, inputvalue47, sep= " ")
write(varroainput47, file = paste(vpdir_in_seed, "input", i, ".txt", sep = ""), append = TRUE, sep = "\n")
write("ESeedConcentration= 0", file = paste(vpdir_in_control, "input", i, ".txt", sep=""), append = TRUE, sep = "\n")
#varroainputweather <- paste(weather, weathervalue, sep= " ")
#write(varroainputweather, file= paste(vpdir_in_foliar, "input", i, ".txt", sep=""), append= TRUE)
}
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
source(paste(vpdir,"src/04read_output.R",sep = ""))
source(paste(vpdir,"src/05load_io.R",sep = ""))
cp_control <- rep(NA, nrows)
cp_foliar <- rep(NA, nrows)
cp_soil <- rep(NA, nrows)
cp_seed <- rep(NA, nrows)
for (n in 1:nrows){
x <- which(tdarray_control[n,1,1:Nsims] > 0) # queries colony size > 1000 for 1000 simulations at each time point
y <- which(tdarray_foliar[n,1,1:Nsims] > 0)
z <- which(tdarray_soil[n,1,1:Nsims] > 0)
zz <- which(tdarray_seed[n,1,1:Nsims] > 0)
cp_control[n] <- length(x)/Nsims #appends vector x with proportion of simulations per time step with Col Size > 0
cp_foliar[n] <- length(y)/Nsims
cp_soil[n] <- length(z)/Nsims
cp_seed[n] <- length(zz)/Nsims
}
#foragers
fa_control <- rep(NA, nrows)
fa_foliar <- rep(NA, nrows)
fa_soil <- rep(NA, nrows)
fa_seed <- rep(NA, nrows)
for (n in 1:nrows){
x <- which(tdarray_control[n,4,1:Nsims] > 0)
y <- which(tdarray_foliar[n,4,1:Nsims] > 0)
z <- which(tdarray_soil[n,4,1:Nsims] > 0)
zz <- which(tdarray_seed[n,4,1:Nsims] > 0)
fa_control[n] <- length(x)/Nsims
fa_foliar[n] <- length(y)/Nsims
fa_soil[n] <- length(z)/Nsims
fa_seed[n] <- length(zz)/Nsims
}
#adult workers
aw_control <- rep(NA, nrows)
aw_foliar <- rep(NA, nrows)
aw_soil <- rep(NA, nrows)
aw_seed <- rep(NA, nrows)
for (n in 1:nrows){
x <- which(tdarray_control[n,3,1:Nsims] > 0)
y <- which(tdarray_foliar[n,3,1:Nsims] > 0)
z <- which(tdarray_soil[n,3,1:Nsims] > 0)
zz <- which(tdarray_seed[n,3,1:Nsims] > 0)
aw_control[n] <- length(x)/Nsims
aw_foliar[n] <- length(y)/Nsims
aw_soil[n] <- length(z)/Nsims
aw_seed[n] <- length(zz)/Nsims
}
#capped worker brood
cwb_control <- rep(NA, nrows)
cwb_foliar <- rep(NA, nrows)
cwb_seed <- rep(NA, nrows)
cwb_soil <- rep(NA, nrows)
for (n in 1:nrows){
x <- which(tdarray_control[n, 6, 1:Nsims] > 0)
y <- which(tdarray_foliar[n, 6, 1:Nsims] > 0)
z <- which(tdarray_seed[n, 6, 1:Nsims] > 0)
zz <- which(tdarray_soil[n, 6, 1:Nsims] > 0)
cwb_control[n] <- length(x)/Nsims
cwb_foliar[n] <- length(y)/Nsims
cwb_seed[n] <- length(z)/Nsims
cwb_soil[n] <- length(zz)/Nsims
}
# #free mites
# fm_con <- rep(NA, nrows)
# fm_exp <- rep(NA, nrows)
# for (n in 1:nrows){
#   x <- which(tdarray_con[n,11,1:Nsims] > 0)
#   y <- which(tdarray_exp[n,11,1:Nsims] > 0)
#   fm_con[n] <- length(x)/Nsims
#   fm_exp[n] <- length(y)/Nsims
# }
#
# #dead foragers
# dfr_con <- rep(NA, nrows)
# dfr_exp <- rep(NA, nrows)
# for (n in 1:nrows){
#   x <- which(tdarray_con[n,1,1:Nsims] > 0)
#   y <- which(tdarray_exp[n,1,1:Nsims] > 0)
#   dfr_con[n] <- length(x)/Nsims
#   dfr_exp[n] <- length(y)/Nsims
# }
#
# #dead mites
# dm_con <- rep(NA, nrows)
# dm_exp <- rep(NA, nrows)
# for (n in 1:nrows){
#   x <- which(tdarray_con[n,16,1:Nsims] > 0)
#   y <- which(tdarray_exp[n,16,1:Nsims] > 0)
#   dm_con[n] <- length(x)/Nsims
#   dm_exp[n] <- length(y)/Nsims
# }
#
# #capped drone brood
# cdb_con <- rep(NA, nrows)
# cdb_exp <- rep(NA, nrows)
# for (n in 1:nrows){
#   x <- which(tdarray_con[n, 5, 1:Nsims] > 0)
#   y <- which(tdarray_exp[n, 5, 1:Nsims] > 0)
#   cdb_con[n] <- length(x)/Nsims
#   cdb_exp[n] <- length(y)/Nsims
# }
#MC proportions ##########
pdf(file= paste(vpdir_fig, "fig_1_MCproportions_convsexp.pdf", sep=""), width = 5, height = 9, onefile = TRUE, paper = "USr")
#start figures
par(mfrow=c(4,1), mar=c(2,4,1,0.5), oma=c(4,2,2,1))
plot(timearray, cp_control, type="l", col="blue", ylab = "P(Colony Size) > 0", ylim=c(0,1), xlab=NA)
lines(timearray, cp_foliar, type="l", lty = 2, col="red")
lines(timearray, cp_seed, type="l", lty = 2, col="black")
lines(timearray, cp_soil, type="l", lty = 2, col="green")
plot(timearray, fa_control, type="l", col="blue", ylab= "P(Foragers) > 0", ylim=c(0,1), xlab=NA)
lines(timearray, fa_foliar, type="l", lty = 2, col="red")
lines(timearray, fa_seed, type="l", lty = 2, col="black")
lines(timearray, fa_soil, type="l", lty = 2, col="green")
plot(timearray, aw_control, type="l", col="blue", ylab= "P(Adult Workers) > 0", ylim=c(0,1), xlab=NA)
lines(timearray, aw_foliar, type="l", lty = 2, col="red")
lines(timearray, aw_seed, type="l", lty = 2, col="black")
lines(timearray, aw_soil, type="l", lty = 2, col="green")
plot(timearray, cwb_control, type="l", col="blue", ylab = "P(Capped Worker Brood) > 0", ylim=c(0,1), xlab=NA)
lines(timearray, cwb_foliar, type="l", lty = 2, col="red")
lines(timearray, cwb_seed, type="l", lty = 2, col="black")
lines(timearray, cwb_soil, type="l", lty = 2, col="green")
#plot(timearray, fm_con, type="l", col="blue", ylab= "P(Free Mites) > 0", ylim=c(0,1), xlab=NA)
#lines(timearray, fm_exp, type="l", lty = 2, col="red")
#plot(timearray, dfr_con, type="l", col="blue", ylab= "P(Dead Foragers) > 0", ylim=c(0,1), xlab=NA)
#lines(timearray, dfr_exp, type="l", lty = 2, col="red")
#mtext(text = paste("Fig. 1 Proportion of simulations with values greater than zero"), side = 1, line = 1, outer = T)
dev.off()
resvar<- c(1,3,4,10,18)
temparray_control <- tdarray_control[1:nrows,resvar,1:Nsims]
temparray_foliar <- tdarray_foliar[1:nrows,resvar,1:Nsims]
temparray_seed <- tdarray_seed[1:nrows,resvar,1:Nsims]
temparray_soil <- tdarray_soil[1:nrows, resvar, 1:Nsims]
dimnames(temparray_control)<- list(c(as.character(timearray)), c(outvar))
dimnames(temparray_foliar)<- list(c(as.character(timearray)), c(outvar))
dimnames(temparray_seed)<- list(c(as.character(timearray)), c(outvar))
dimnames(temparray_soil)<- list(c(as.character(timearray)), c(outvar))
tempout_control<- array(data=NA, c(nrows,5,3), dimnames = list(c(as.character(timearray)),
c("Colony Size","Adult Workers", "Foragers", "Worker Eggs", "Colony Pollen (g)"),
c("25%","50%","75%")))
tempout_foliar<- array(data=NA, c(nrows,5,3), dimnames = list(c(as.character(timearray)),
c("Colony Size","Adult Workers", "Foragers", "Worker Eggs", "Colony Pollen (g)"),
c("25%","50%","75%")))
tempout_seed<- array(data=NA, c(nrows,5,3), dimnames = list(c(as.character(timearray)),
c("Colony Size","Adult Workers", "Foragers", "Worker Eggs", "Colony Pollen (g)"),
c("25%","50%","75%")))
tempout_soil<- array(data=NA, c(nrows,5,3), dimnames = list(c(as.character(timearray)),
c("Colony Size","Adult Workers", "Foragers", "Worker Eggs", "Colony Pollen (g)"),
c("25%","50%","75%")))
for (r in 1:5){
for (t in 1:nrows){
p<- quantile(temparray_control[t, r, 1:Nsims])
z<- quantile(temparray_foliar[t, r, 1:Nsims])
q<- quantile(temparray_seed[t, r, 1:Nsims])
n<- quantile(temparray_soil[t,r,1:Nsims])
for (s in 1:3){
quant_control<- c(p[[2]], p[[3]], p[[4]])
quant_foliar<- c(z[[2]], z[[3]], z[[4]])
quant_seed<- c(q[[2]],q[[3]],q[[4]])
quant_soil<- c(n[[2]],n[[3]],n[[4]])
tempout_control[t,r,s]<- quant_control[s]
tempout_foliar[t,r,s]<- quant_foliar[s]
tempout_seed[t,r,s]<- quant_seed[s]
tempout_soil[t,r,s]<- quant_soil[s]
}
}
}
#create PDF timeseries
pdf(file= paste(vpdir_fig, "fig_quantile_timeseries.pdf", sep=""), width = 8.5, height = 11, onefile = TRUE, paper = "USr")
#start figures
#time series plots
par(mfrow=c(4,3), mar=c(2, 4, 2, 0.5), oma= c(3,2,2,6.5))
for (r in 1:4){
plot(timearray, tempout_control[,r,2], type = "l", ylim = c(0,max(tempout_control[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Control")
lines(timearray, tempout_control[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_control[,r,3], type = "l", lty= 4, col = "blue")
plot(timearray, tempout_foliar[,r,2], type = "l", ylim = c(0,max(tempout_foliar[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Foliar")
lines(timearray, tempout_foliar[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_foliar[,r,3], type = "l", lty= 4, col = "blue")
# plot(timearray, tempout_seed[,r,2], type = "l", ylim = c(0,max(tempout_seed[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Seed")
# lines(timearray, tempout_seed[,r,1], type = "l", lty= 2, col = "red")
# lines(timearray, tempout_seed[,r,3], type = "l", lty= 4, col = "blue")
plot(timearray, tempout_soil[,r,2], type = "l", ylim = c(0,max(tempout_soil[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Soil")
lines(timearray, tempout_soil[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_soil[,r,3], type = "l", lty= 4, col = "blue")
}
#mtext(text = paste("Fig. 14 Time series plots of lower, middle, and upper quartiles."), side = 1, line = 1, outer = T)
dev.off()
pdf(file= paste(vpdir_fig, "fig_quantile_timeseries.pdf", sep=""), width = 8.5, height = 11, onefile = TRUE, paper = "USr")
#start figures
#time series plots
par(mfrow=c(4,4), mar=c(2, 4, 2, 0.5), oma= c(3,2,2,6.5))
for (r in 1:4){
plot(timearray, tempout_control[,r,2], type = "l", ylim = c(0,max(tempout_control[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Control")
lines(timearray, tempout_control[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_control[,r,3], type = "l", lty= 4, col = "blue")
plot(timearray, tempout_foliar[,r,2], type = "l", ylim = c(0,max(tempout_foliar[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Foliar")
lines(timearray, tempout_foliar[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_foliar[,r,3], type = "l", lty= 4, col = "blue")
plot(timearray, tempout_seed[,r,2], type = "l", ylim = c(0,max(tempout_seed[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Seed")
lines(timearray, tempout_seed[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_seed[,r,3], type = "l", lty= 4, col = "blue")
plot(timearray, tempout_soil[,r,2], type = "l", ylim = c(0,max(tempout_soil[,r,3])), ylab= paste(outvar[r]), xlab = NA, main= "Soil")
lines(timearray, tempout_soil[,r,1], type = "l", lty= 2, col = "red")
lines(timearray, tempout_soil[,r,3], type = "l", lty= 4, col = "blue")
}
#mtext(text = paste("Fig. 14 Time series plots of lower, middle, and upper quartiles."), side = 1, line = 1, outer = T)
dev.off()
out_control_colsize <- tdarray_control[,1,1:Nsims]
out_foliar_colsize <- tdarray_foliar[,1,1:Nsims]
out_seed_colsize <- tdarray_seed[,1,1:Nsims]
out_soil_colsize <- tdarray_soil[,1,1:Nsims]
avg_control_colsize <- colMeans(out_control_colsize) #average across entire simulation period
avg_foliar_colsize <- colMeans(out_foliar_colsize) #average across enture simulation period
avg_seed_colsize <- colMeans(out_seed_colsize) #average across enture simulation period
avg_soil_colsize <- colMeans(out_soil_colsize) #average across enture simulation period
pcctdarray_control<- array(data=NA, c(1,1,length(inputdata_control)), dimnames = list(c("x"),
c("Colony Size"),
c(colnames(inputdata_control))))
pcctdarray_foliar<- array(data=NA, c(1,1,length(inputdata_foliar)), dimnames = list(c("x"),
c("Colony Size"),
c(colnames(inputdata_foliar))))
pcctdarray_seed<- array(data=NA, c(1,1,length(inputdata_seed)), dimnames = list(c("x"),
c("Colony Size"),
c(colnames(inputdata_seed))))
pcctdarray_soil<- array(data=NA, c(1,1,length(inputdata_soil)), dimnames = list(c("x"),
c("Colony Size"),
c(colnames(inputdata_soil))))
# #PCC control
# for (i in 800){
#   for (j in 1){   #output variable
#     for (k in 1:length(inputdata_con)){  #input variable
#       tempinput<- tdoutput_con[1:Nsims]
#       temp<- pcc(inputdata_con[1:Nsims,], tempinput, rank = T)
#       pcctdarray_con[1,j,k]<- temp$PRCC[[1]][k]
#       print(i)
#     }
#   }
# }
#
# #PCC exposed
# for (i in 800){  #break
#   for (j in 1){   #output variable
#     for (k in 1:length(inputdata_exp)){  #input variable
#       tempinput<- tdoutput_exp[1:Nsims]
#       temp<- pcc(inputdata_exp[1:Nsims,], tempinput, rank = T)
#       pcctdarray_exp[1,j,k]<- temp$PRCC[[1]][k]
#       print(i)
#     }
#   }
# }
for (k in 1:length(inputdata_control)){  #input variable
temp_control<- pcc(inputdata_control, avg_control_colsize, rank = T)
pcctdarray_control[,,k]<- temp_control$PRCC[[1]][k]
}
for (k in 1:length(inputdata_foliar)){  #input variable
temp_foliar<- pcc(inputdata_foliar, avg_foliar_colsize, rank = T)
pcctdarray_foliar[,,k]<- temp_foliar$PRCC[[1]][k]
}
for (k in 1:length(inputdata_seed)){  #input variable
temp_seed<- pcc(inputdata_seed, avg_seed_colsize, rank = T)
pcctdarray_seed[,,k]<- temp_seed$PRCC[[1]][k]
}
for (k in 1:length(inputdata_soil)){  #input variable
temp_soil<- pcc(inputdata_soil, avg_soil_colsize, rank = T)
pcctdarray_soil[,,k]<- temp_soil$PRCC[[1]][k]
}
#dfpcc_con<- ldply(pcctdarray_con, rbind)
#colnames(dfpcc_con)<- c("Colony Size")
dfpcc_control<- melt(pcctdarray_control)
dfpcc_foliar <- melt(pcctdarray_foliar)
dfpcc_seed <- melt(pcctdarray_seed)
dfpcc_soil <- melt(pcctdarray_soil)
pdf(file= paste(vpdir_fig, "fig_tornado_colonysize.pdf", sep=""), width = 8.5, height = 11, onefile = TRUE, paper = "USr")
#start figures
#create plot pages
grid.newpage()
pushViewport(viewport(layout=grid.layout(1,4), gp= gpar(cex = 0.6)))
#start figures
aa<- ggplot(data=dfpcc_control, aes(x= dfpcc_control[[3]], y= dfpcc_control[[4]])) +
geom_bar(stat="identity", position = "identity") +
scale_y_continuous(limits= c(-1,1)) +
coord_flip() +
labs(title= "Control", x=" ", y= "Partial Correlation Coefficient") +
#facet_grid(. ~ Colony Size) +
theme_bw()
print(aa, vp= viewport(layout.pos.row= 1, layout.pos.col= 1), newpage= FALSE)
bb<- ggplot(data=dfpcc_foliar, aes(x= dfpcc_foliar[[3]], y= dfpcc_foliar[[4]])) +
geom_bar(stat="identity", position = "identity") +
scale_y_continuous(limits= c(-1,1)) +
coord_flip() +
labs(title= "Foliar", x=" ", y= "Partial Correlation Coefficient") +
#facet_grid(. ~ Var2) +
theme_bw()
print(bb, vp= viewport(layout.pos.row= 1, layout.pos.col= 2), newpage= FALSE)
cc<- ggplot(data=dfpcc_seed, aes(x= dfpcc_seed[[3]], y= dfpcc_seed[[4]])) +
geom_bar(stat="identity", position = "identity") +
scale_y_continuous(limits= c(-1,1)) +
coord_flip() +
labs(title= "Seed", x=" ", y= "Partial Correlation Coefficient") +
#facet_grid(. ~ Var2) +
theme_bw()
print(cc, vp= viewport(layout.pos.row= 1, layout.pos.col= 3), newpage= FALSE)
dd<- ggplot(data=dfpcc_soil, aes(x= dfpcc_soil[[3]], y= dfpcc_soil[[4]])) +
geom_bar(stat="identity", position = "identity") +
scale_y_continuous(limits= c(-1,1)) +
coord_flip() +
labs(title= "Soil", x=" ", y= "Partial Correlation Coefficient") +
#facet_grid(. ~ Var2) +
theme_bw()
print(dd, vp= viewport(layout.pos.row= 1, layout.pos.col= 4), newpage= FALSE)
dev.off()
library(plyr)
library(reshape2)
library(ggplot2)
library(grid)
library(gridExtra)
library(sensitivity)
library(abind)
#echo environment
Sys.info()
Sys.info()[4]
.Platform
version
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison_carmen.vrp"
}
if(Sys.info()[4]=="ACKUAN-PC"){
vpdir<-path.expand("C:/gitrepo/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison_carmen.vrp"
}
Sys.info()
Sys.info()[4]
.Platform
version
if(Sys.info()[4]=="DZ2626UCKUAN"){
vpdir<-path.expand("C:/Users/ckuan/git/beeRpop/")
# varroapop file (without directory, the file needs to be in vpdir_exe above)
vrp_filename <- "comparison_carmen.vrp"
}
vpdir_input <- paste(vpdir, "input/", sep = "")
vpdir_output <- paste(vpdir, "output/", sep = "")
vpdir_log <- paste(vpdir, "log/", sep = "")
vpdir_fig <- paste(vpdir, "figures/", sep = "")
vpdir_exe <- paste(vpdir, "exe/", sep = "")
vpdir_io <- paste(vpdir, "io/", sep = "")
vpdir_in_foliar <- paste(vpdir_input, "foliar/", sep = "")
vpdir_in_control <- paste(vpdir_input, "control/", sep = "")
vpdir_in_seed <- paste(vpdir_input, "seed/", sep = "")
vpdir_in_soil <- paste(vpdir_input, "soil/", sep = "")
vpdir_out_foliar <- paste(vpdir_output, "foliar/", sep = "")
vpdir_out_control <- paste(vpdir_output, "control/", sep = "")
vpdir_out_seed <- paste(vpdir_output, "seed/", sep = "")
vpdir_out_soil <- paste(vpdir_output, "soil/", sep = "")
vpdir_weather <- paste(vpdir, "weather/", sep = "")
vpdir_sobol <- paste(vpdir, "sobol/", sep = "")
#varroapop executable version
vp_binary <- "VarroaPop_3_2_6_6.exe"
vpdir_executable <- paste(vpdir_exe, vp_binary, sep="")
vrp_weather <- "w93193-tempadj.dvf"
simstart <- "01/01/1988"
simend <- "12/31/1990"
Nsims <- 1000
source(paste(vpdir,"src/01parameterize_simulation.R",sep = ""))
scan(file = paste(vpdir_log, "log1.txt", sep=""), what = "raw")
source(paste(vpdir,"src/01parameterize_simulation.R",sep = ""))
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
# define distributions for input parameters
source(paste(vpdir,"src/01parameterize_simulation.R",sep = ""))
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
#may need to turn off virus checker!
# automate simulations for 'Nsims' number of simulations
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
source(paste(vpdir,"src/02write_input.R",sep = ""))
source(paste(vpdir,"src/03simulate_w_exe.R",sep = ""))
vpdir_command
vpdir_executable
